<div style="padding: 10px; font-family: sans-serif; background-color: #121212; color: #e0e0e0; min-height: 100vh;">
  <h1 style="font-size: 1.5rem; text-align: center; color: #bb86fc;"><%= Date.today.month %>月の 記録</h1>

  <div style="overflow-x: auto; -webkit-overflow-scrolling: touch; max-height: 80vh; border: 1px solid #444;">
    <table style="width: 100%; border-collapse: collapse; min-width: 850px; background: #1e1e1e;">
      <thead>
        <tr style="background-color: #333; position: sticky; top: 0; z-index: 20;">
          <th style="border: 1px solid #444; padding: 10px; position: sticky; left: 0; background: #333; color: #fff; z-index: 30;">日にち</th>
          <% @tasks.each do |task| %>
            <th style="border: 1px solid #444; padding: 10px; font-size: 0.8rem; min-width: 90px; color: #fff;">
              <%= task.name %>
            </th>
          <% end %>
        </tr>
      </thead>
      <tbody>
        <% @dates.each do |date| %>
          <tr style="border-bottom: 1px solid #333;">
            <td style="border: 1px solid #444; padding: 10px; font-weight: bold; position: sticky; left: 0; background: #1e1e1e; color: #bb86fc; white-space: nowrap; z-index: 10;">
              <%= date.strftime("%m/%d(#{%w(日 月 火 水 木 金 土)[date.wday]})") %>
            </td>
            <% @tasks.each do |task| %>
              <% time = @logs_map[[date, task.id]] %>
              <td style="border: 1px solid #444; padding: 10px; text-align: center; <%= time ? 'background: #004d40;' : '' %>">
                <% if time %>
                  <% log = TaskLog.find_by(completed_at: date.beginning_of_day..date.end_of_day, task_id: task.id) %>
                  <span style="font-size: 1rem; font-weight: bold; color: #03dac6;"><%= time %></span><br>
                  <div style="font-size: 0.75rem; margin-top: 5px;">
                    <%= link_to '修正', edit_task_log_path(log), style: "color: #03a9f4;" %> | 
                    <%= link_to '消去', delete_log_task_log_path(log), data: { confirm: '消去しても いいですか？' }, style: "color: #cf6679;" %>
                  </div>
                <% else %>
                  <span style="color: #444;">-</span>
                <% end %>
              </td>
            <% end %>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>